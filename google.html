<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=no,viewport-fit=cover">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<title>Sitemap XML Olu≈üturucu</title>

<!-- Fonts -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

<style>
/* === Variables === */
:root{
  --primary:#10b981;
  --primary-dark:#059669;
  --secondary:#06b6d4;
  --accent:#f59e0b;
  --danger:#ef4444;
  --text-primary:#1e293b;
  --text-secondary:#475569;
  --text-muted:#64748b;
  --success:#22c55e;
  --warning:#eab308;
}

/* === Reset === */
*{
  margin:0;
  padding:0;
  box-sizing:border-box;
  -webkit-tap-highlight-color:transparent;
}

html, body {
  height: 100%;
  width: 100%;
  overflow: hidden;
  position: fixed;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior: none;
}

body{
  font-family:'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;
  background:#fefce8;
  color:var(--text-primary);
  line-height:1.6;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  touch-action: manipulation;
}

/* === Main Container === */
.main-wrapper {
  height: 100%;
  width: 100%;
  overflow-y: auto;
  overflow-x: hidden;
  -webkit-overflow-scrolling: touch;
  overscroll-behavior-y: contain;
  position: relative;
  z-index: 1;
}

/* === Background === */
.bg-gradient{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background: 
    linear-gradient(135deg, #dcfce7 0%, #bbf7d0 25%, #86efac 50%, #4ade80 75%, #22c55e 100%);
  background-size: 200% 200%;
  animation: gradientShift 20s ease infinite;
  z-index:-2;
  pointer-events:none;
}

@keyframes gradientShift {
  0%, 100% { background-position: 0% 0%; }
  50% { background-position: 100% 100%; }
}

.bg-overlay{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background: 
    radial-gradient(ellipse at top left, rgba(16, 185, 129, 0.1) 0%, transparent 50%),
    radial-gradient(ellipse at bottom right, rgba(6, 182, 212, 0.1) 0%, transparent 50%),
    linear-gradient(180deg, rgba(255,255,255,0.7) 0%, rgba(255,255,255,0.3) 100%);
  z-index:-1;
  pointer-events:none;
}

/* === Container === */
.container{
  position:relative;
  z-index:1;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  padding: 20px;
  max-width: 1400px;
  margin: 0 auto;
}

/* === Header === */
.header{
  text-align:center;
  margin-bottom: 30px;
  background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  border-radius: 20px;
  padding: 30px 20px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.08);
  border: 1px solid rgba(255,255,255,0.5);
}

.title{
  font-size:clamp(2rem,4vw,3rem);
  font-weight:700;
  margin-bottom:10px;
  letter-spacing:-0.02em;
  background: linear-gradient(135deg, var(--primary), var(--secondary));
  -webkit-background-clip: text;
  -webkit-text-fill-color: transparent;
  background-clip: text;
}

.subtitle{
  font-size:clamp(1rem,2vw,1.2rem);
  font-weight:400;
  color:#475569;
  opacity:0.9;
}

/* === Editor Panel === */
.editor-container {
  background: linear-gradient(135deg, rgba(255,255,255,0.98) 0%, rgba(255,255,255,0.95) 100%);
  backdrop-filter: blur(20px);
  -webkit-backdrop-filter: blur(20px);
  border: 2px solid rgba(16, 185, 129, 0.2);
  border-radius: 20px;
  padding: 30px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.1);
  margin-bottom: 30px;
}

.section {
  margin-bottom: 30px;
}

.section-title {
  font-size: 18px;
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: 15px;
  display: flex;
  align-items: center;
  gap: 10px;
}

.section-icon {
  font-size: 24px;
}

/* === Form Elements === */
.form-group {
  margin-bottom: 20px;
}

.form-label {
  display: block;
  font-size: 14px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.form-input {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e2e8f0;
  border-radius: 10px;
  font-size: 14px;
  transition: all 0.3s ease;
  background: white;
}

.form-input:focus {
  outline: none;
  border-color: var(--primary);
  box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
}

.form-select {
  width: 100%;
  padding: 12px 15px;
  border: 2px solid #e2e8f0;
  border-radius: 10px;
  font-size: 14px;
  background: white;
  cursor: pointer;
  transition: all 0.3s ease;
}

.form-select:focus {
  outline: none;
  border-color: var(--primary);
}

/* === File Upload === */
.file-upload-container {
  border: 3px dashed rgba(16, 185, 129, 0.3);
  border-radius: 15px;
  padding: 40px 20px;
  text-align: center;
  background: linear-gradient(135deg, rgba(220, 252, 231, 0.2) 0%, rgba(187, 247, 208, 0.1) 100%);
  transition: all 0.3s ease;
  cursor: pointer;
  position: relative;
}

.file-upload-container:hover {
  border-color: var(--primary);
  background: linear-gradient(135deg, rgba(220, 252, 231, 0.4) 0%, rgba(187, 247, 208, 0.2) 100%);
}

.file-upload-container.active {
  border-color: var(--primary);
  background: linear-gradient(135deg, rgba(220, 252, 231, 0.6) 0%, rgba(187, 247, 208, 0.3) 100%);
}

.file-input {
  display: none;
}

.file-upload-icon {
  font-size: 48px;
  margin-bottom: 15px;
  opacity: 0.7;
}

.file-upload-text {
  font-size: 16px;
  font-weight: 500;
  color: var(--text-primary);
  margin-bottom: 8px;
}

.file-upload-hint {
  font-size: 13px;
  color: var(--text-muted);
}

.file-info {
  margin-top: 15px;
  padding: 15px;
  background: linear-gradient(135deg, rgba(34, 197, 94, 0.1) 0%, rgba(16, 185, 129, 0.05) 100%);
  border-radius: 10px;
  font-size: 14px;
  color: var(--primary-dark);
  display: none;
}

.file-info.show {
  display: block;
  animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(-10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* === URL List Preview === */
.url-preview-container {
  max-height: 400px;
  overflow-y: auto;
  border: 1px solid #e2e8f0;
  border-radius: 10px;
  padding: 15px;
  background: white;
  margin-top: 20px;
}

.url-preview-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 2px solid #f3f4f6;
}

.url-count {
  font-size: 14px;
  font-weight: 600;
  color: var(--primary);
}

.url-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.url-item {
  display: flex;
  align-items: center;
  padding: 10px;
  background: #f9fafb;
  border-radius: 8px;
  border: 1px solid #e5e7eb;
  transition: all 0.2s ease;
  font-size: 13px;
  word-break: break-all;
}

.url-item:hover {
  background: #f3f4f6;
  border-color: var(--primary);
}

.url-number {
  flex-shrink: 0;
  width: 30px;
  height: 30px;
  background: var(--primary);
  color: white;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 12px;
  font-weight: 600;
  margin-right: 12px;
}

.url-text {
  flex: 1;
  color: var(--text-secondary);
}

.remove-url {
  flex-shrink: 0;
  width: 28px;
  height: 28px;
  background: var(--danger);
  color: white;
  border: none;
  border-radius: 50%;
  cursor: pointer;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 16px;
  transition: all 0.2s ease;
  opacity: 0.7;
}

.remove-url:hover {
  opacity: 1;
  transform: scale(1.1);
}

/* === Buttons === */
.btn {
  padding: 14px 28px;
  border: none;
  border-radius: 10px;
  font-size: 15px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.3s ease;
  display: inline-flex;
  align-items: center;
  gap: 8px;
}

.btn-primary {
  background: linear-gradient(135deg, var(--primary), var(--primary-dark));
  color: white;
  box-shadow: 0 4px 15px rgba(16, 185, 129, 0.3);
}

.btn-primary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
}

.btn-secondary {
  background: linear-gradient(135deg, #64748b, #475569);
  color: white;
}

.btn-secondary:hover {
  transform: translateY(-2px);
  box-shadow: 0 8px 25px rgba(100, 116, 139, 0.3);
}

.btn-warning {
  background: linear-gradient(135deg, var(--warning), #d97706);
  color: white;
}

.btn-danger {
  background: linear-gradient(135deg, var(--danger), #dc2626);
  color: white;
}

.btn-group {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
  margin-top: 20px;
}

.btn-full {
  width: 100%;
  justify-content: center;
}

/* === Success Message === */
.success-message {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  background: linear-gradient(135deg, var(--success), var(--primary));
  color: white;
  padding: 30px 40px;
  border-radius: 15px;
  box-shadow: 0 20px 60px rgba(34, 197, 94, 0.4);
  font-size: 18px;
  font-weight: 600;
  display: none;
  z-index: 1000;
  animation: successPop 0.5s ease;
}

@keyframes successPop {
  0% { transform: translate(-50%, -50%) scale(0.8); opacity: 0; }
  50% { transform: translate(-50%, -50%) scale(1.05); }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 1; }
}

.success-message.show {
  display: block;
}

/* === Info Box === */
.info-box {
  background: linear-gradient(135deg, #dbeafe, #bfdbfe);
  border: 2px solid #3b82f6;
  border-radius: 10px;
  padding: 15px;
  margin: 15px 0;
  font-size: 13px;
  line-height: 1.8;
}

.info-box-title {
  font-weight: 600;
  color: #1e40af;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.info-box ul {
  margin-left: 20px;
  margin-top: 10px;
}

.info-box li {
  margin-bottom: 5px;
  color: #1e3a8a;
}

/* === Stats Cards === */
.stats-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
  gap: 20px;
  margin-bottom: 30px;
}

.stat-card {
  background: linear-gradient(135deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.85) 100%);
  border: 1px solid rgba(0,0,0,0.08);
  border-radius: 15px;
  padding: 20px;
  text-align: center;
  box-shadow: 0 4px 15px rgba(0,0,0,0.05);
  transition: all 0.3s ease;
}

.stat-card:hover {
  transform: translateY(-5px);
  box-shadow: 0 8px 25px rgba(0,0,0,0.1);
}

.stat-value {
  font-size: 32px;
  font-weight: 700;
  color: var(--primary);
  margin-bottom: 5px;
}

.stat-label {
  font-size: 14px;
  color: var(--text-muted);
  font-weight: 500;
}

/* === XML Preview === */
.xml-preview {
  background: #1e293b;
  color: #e2e8f0;
  padding: 20px;
  border-radius: 10px;
  font-family: 'Courier New', monospace;
  font-size: 13px;
  line-height: 1.6;
  max-height: 400px;
  overflow: auto;
  margin-top: 20px;
  white-space: pre-wrap;
  word-break: break-all;
}

.xml-tag { color: #60a5fa; }
.xml-attr { color: #fbbf24; }
.xml-value { color: #86efac; }

/* === Mobile Responsive === */
@media (max-width: 768px) {
  .container {
    padding: 15px;
  }
  
  .header {
    padding: 20px 15px;
  }
  
  .title {
    font-size: 1.8rem;
  }
  
  .editor-container {
    padding: 20px;
  }
  
  .btn-group {
    flex-direction: column;
  }
  
  .btn {
    width: 100%;
    justify-content: center;
  }
  
  .stats-container {
    grid-template-columns: 1fr;
  }
}

/* === Loading Spinner === */
.spinner {
  display: inline-block;
  width: 20px;
  height: 20px;
  border: 3px solid rgba(255,255,255,0.3);
  border-radius: 50%;
  border-top-color: white;
  animation: spin 0.8s linear infinite;
}

@keyframes spin {
  to { transform: rotate(360deg); }
}

/* === Toggle Switch === */
.toggle-container {
  display: flex;
  align-items: center;
  gap: 12px;
}

.toggle-switch {
  position: relative;
  width: 50px;
  height: 26px;
  background: #cbd5e1;
  border-radius: 34px;
  cursor: pointer;
  transition: background 0.3s ease;
}

.toggle-switch.active {
  background: var(--primary);
}

.toggle-slider {
  position: absolute;
  content: "";
  height: 20px;
  width: 20px;
  left: 3px;
  bottom: 3px;
  background: white;
  border-radius: 50%;
  transition: transform 0.3s ease;
}

.toggle-switch.active .toggle-slider {
  transform: translateX(24px);
}

.toggle-label {
  font-size: 14px;
  font-weight: 500;
  color: var(--text-secondary);
}
</style>
</head>

<body>
  <!-- Background elements -->
  <div class="bg-gradient"></div>
  <div class="bg-overlay"></div>

  <!-- Main wrapper -->
  <div class="main-wrapper">
    <div class="container">
      <!-- Header -->
      <div class="header">
        <h1 class="title">üó∫Ô∏è Sitemap XML Olu≈üturucu</h1>
        <p class="subtitle">CSV dosyanƒ±zdan otomatik XML sitemap olu≈üturun</p>
      </div>

      <!-- Stats -->
      <div class="stats-container">
        <div class="stat-card">
          <div class="stat-value" id="totalUrls">0</div>
          <div class="stat-label">Toplam URL</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="validUrls">0</div>
          <div class="stat-label">Ge√ßerli URL</div>
        </div>
        <div class="stat-card">
          <div class="stat-value" id="invalidUrls">0</div>
          <div class="stat-label">Hatalƒ± URL</div>
        </div>
      </div>

      <!-- Editor Container -->
      <div class="editor-container">
        
        <!-- Settings Section -->
        <div class="section">
          <h2 class="section-title">
            <span class="section-icon">‚öôÔ∏è</span>
            Sitemap Ayarlarƒ±
          </h2>
          
          <div class="form-group">
            <label class="form-label">Ana Domain (Opsiyonel)</label>
            <input type="text" class="form-input" id="mainDomain" placeholder="https://example.com (Bo≈ü bƒ±rakƒ±rsanƒ±z CSV'deki URL'ler kullanƒ±lƒ±r)">
          </div>
          
          <div class="form-group">
            <label class="form-label">Varsayƒ±lan G√ºncelleme Sƒ±klƒ±ƒüƒ±</label>
            <select class="form-select" id="changefreq">
              <option value="always">Always (Her zaman)</option>
              <option value="hourly">Hourly (Saatlik)</option>
              <option value="daily" selected>Daily (G√ºnl√ºk)</option>
              <option value="weekly">Weekly (Haftalƒ±k)</option>
              <option value="monthly">Monthly (Aylƒ±k)</option>
              <option value="yearly">Yearly (Yƒ±llƒ±k)</option>
              <option value="never">Never (Asla)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label class="form-label">Varsayƒ±lan √ñncelik (0.0 - 1.0)</label>
            <input type="number" class="form-input" id="priority" value="0.8" min="0" max="1" step="0.1">
          </div>
          
          <div class="form-group">
            <div class="toggle-container">
              <div class="toggle-switch active" id="autoLastmod" onclick="toggleSwitch(this)">
                <div class="toggle-slider"></div>
              </div>
              <span class="toggle-label">Otomatik lastmod (bug√ºn√ºn tarihi)</span>
            </div>
          </div>
        </div>

        <!-- File Upload Section -->
        <div class="section">
          <h2 class="section-title">
            <span class="section-icon">üìÅ</span>
            CSV Dosya Y√ºkleme
          </h2>
          
          <div class="info-box">
            <div class="info-box-title">
              ‚ÑπÔ∏è CSV Formatƒ± Hakkƒ±nda
            </div>
            <strong>Desteklenen formatlar:</strong>
            <ul>
              <li>Tek s√ºtun: Sadece URL'ler</li>
              <li>ƒ∞ki s√ºtun: URL, Priority (√∂ncelik)</li>
              <li>√ú√ß s√ºtun: URL, Priority, Changefreq (g√ºncelleme sƒ±klƒ±ƒüƒ±)</li>
              <li>D√∂rt s√ºtun: URL, Priority, Changefreq, Lastmod (son deƒüi≈üiklik)</li>
            </ul>
          </div>
          
          <div class="file-upload-container" id="dropZone">
            <input type="file" id="csvFile" accept=".csv,.txt" class="file-input">
            <div class="file-upload-icon">üìä</div>
            <div class="file-upload-text">CSV dosyanƒ±zƒ± se√ßin veya s√ºr√ºkleyin</div>
            <div class="file-upload-hint">(.csv veya .txt uzantƒ±lƒ± dosyalar)</div>
            <div class="file-info" id="fileInfo"></div>
          </div>
        </div>

        <!-- Manual URL Entry -->
        <div class="section">
          <h2 class="section-title">
            <span class="section-icon">‚úèÔ∏è</span>
            Manuel URL Ekleme
          </h2>
          
          <div class="form-group">
            <label class="form-label">URL Ekle (Her satƒ±ra bir URL)</label>
            <textarea class="form-input" id="manualUrls" rows="5" placeholder="https://example.com/page1&#10;https://example.com/page2&#10;https://example.com/page3"></textarea>
          </div>
          
          <button class="btn btn-secondary" onclick="addManualUrls()">
            <span>‚ûï</span>
            Manuel URL'leri Ekle
          </button>
        </div>

        <!-- URL Preview -->
        <div class="section" id="previewSection" style="display: none;">
          <h2 class="section-title">
            <span class="section-icon">üìã</span>
            URL Listesi
          </h2>
          
          <div class="url-preview-container">
            <div class="url-preview-header">
              <span class="url-count">Toplam: <span id="urlCount">0</span> URL</span>
              <button class="btn btn-danger" onclick="clearAllUrls()">T√ºm√ºn√º Temizle</button>
            </div>
            <div class="url-list" id="urlList"></div>
          </div>
        </div>

        <!-- XML Preview -->
        <div class="section" id="xmlPreviewSection" style="display: none;">
          <h2 class="section-title">
            <span class="section-icon">üëÅÔ∏è</span>
            XML √ñnizleme
          </h2>
          <div class="xml-preview" id="xmlPreview"></div>
        </div>

        <!-- Action Buttons -->
        <div class="btn-group">
          <button class="btn btn-primary btn-full" onclick="generateSitemap()" id="generateBtn">
            <span>üöÄ</span>
            Sitemap Olu≈ütur ve Kopyala
          </button>
          <button class="btn btn-warning" onclick="downloadSitemap()" id="downloadBtn" style="display: none;">
            <span>üíæ</span>
            XML ƒ∞ndir
          </button>
          <button class="btn btn-secondary" onclick="resetAll()">
            <span>üîÑ</span>
            Sƒ±fƒ±rla
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Success Message -->
  <div class="success-message" id="successMessage">
    ‚úÖ Sitemap ba≈üarƒ±yla olu≈üturuldu ve panoya kopyalandƒ±!
  </div>

<script>
// Global variables
let urlList = [];
let xmlContent = '';

// Initialize
document.addEventListener('DOMContentLoaded', function() {
  setupEventListeners();
  updateToday();
});

// Setup event listeners
function setupEventListeners() {
  // File upload
  const dropZone = document.getElementById('dropZone');
  const fileInput = document.getElementById('csvFile');
  
  dropZone.addEventListener('click', () => fileInput.click());
  
  dropZone.addEventListener('dragover', (e) => {
    e.preventDefault();
    dropZone.classList.add('active');
  });
  
  dropZone.addEventListener('dragleave', () => {
    dropZone.classList.remove('active');
  });
  
  dropZone.addEventListener('drop', (e) => {
    e.preventDefault();
    dropZone.classList.remove('active');
    
    const files = e.dataTransfer.files;
    if (files.length > 0) {
      handleFile(files[0]);
    }
  });
  
  fileInput.addEventListener('change', (e) => {
    if (e.target.files.length > 0) {
      handleFile(e.target.files[0]);
    }
  });
}

// Update today's date
function updateToday() {
  const today = new Date().toISOString().split('T')[0];
  window.todayDate = today;
}

// Toggle switch
function toggleSwitch(element) {
  element.classList.toggle('active');
}

// Handle file
function handleFile(file) {
  const reader = new FileReader();
  const fileInfo = document.getElementById('fileInfo');
  
  reader.onload = function(e) {
    try {
      const content = e.target.result;
      const lines = content.split(/\r?\n/).filter(line => line.trim());
      
      fileInfo.innerHTML = `‚úÖ ${file.name} y√ºklendi (${lines.length} satƒ±r)`;
      fileInfo.classList.add('show');
      
      processCSV(lines);
      
    } catch (error) {
      fileInfo.innerHTML = `‚ùå Hata: ${error.message}`;
      fileInfo.classList.add('show');
    }
  };
  
  reader.readAsText(file, 'UTF-8');
}

// Process CSV
function processCSV(lines) {
  const mainDomain = document.getElementById('mainDomain').value.trim();
  const tempUrls = [];
  
  for (let line of lines) {
    const parts = parseCSVLine(line);
    
    if (parts.length > 0) {
      let url = parts[0].trim();
      
      // Remove quotes
      url = url.replace(/^["']|["']$/g, '');
      
      // Skip empty
      if (!url) continue;
      
      // Add domain if needed
      if (mainDomain && !url.startsWith('http')) {
        url = mainDomain + (url.startsWith('/') ? '' : '/') + url;
      }
      
      // Create URL object
      const urlObj = {
        loc: url,
        priority: parts[1] ? parseFloat(parts[1]) : parseFloat(document.getElementById('priority').value),
        changefreq: parts[2] || document.getElementById('changefreq').value,
        lastmod: parts[3] || (document.getElementById('autoLastmod').classList.contains('active') ? window.todayDate : null)
      };
      
      // Validate URL
      if (isValidUrl(urlObj.loc)) {
        tempUrls.push(urlObj);
      }
    }
  }
  
  // Add to main list
  urlList = urlList.concat(tempUrls);
  updateDisplay();
}

// Parse CSV line
function parseCSVLine(line) {
  const result = [];
  let current = '';
  let inQuotes = false;
  
  for (let char of line) {
    if (char === '"') {
      inQuotes = !inQuotes;
    } else if (char === ',' && !inQuotes) {
      result.push(current.trim());
      current = '';
    } else {
      current += char;
    }
  }
  
  if (current || result.length > 0) {
    result.push(current.trim());
  }
  
  return result;
}

// Validate URL
function isValidUrl(url) {
  try {
    // Basic URL validation
    if (!url || url.length < 4) return false;
    
    // Check if it starts with http or https
    if (!url.startsWith('http://') && !url.startsWith('https://')) {
      return false;
    }
    
    // Try to create URL object
    new URL(url);
    return true;
  } catch {
    return false;
  }
}

// Add manual URLs
function addManualUrls() {
  const textarea = document.getElementById('manualUrls');
  const lines = textarea.value.split('\n').filter(line => line.trim());
  const mainDomain = document.getElementById('mainDomain').value.trim();
  
  for (let url of lines) {
    url = url.trim();
    
    // Add domain if needed
    if (mainDomain && !url.startsWith('http')) {
      url = mainDomain + (url.startsWith('/') ? '' : '/') + url;
    }
    
    // Create URL object
    const urlObj = {
      loc: url,
      priority: parseFloat(document.getElementById('priority').value),
      changefreq: document.getElementById('changefreq').value,
      lastmod: document.getElementById('autoLastmod').classList.contains('active') ? window.todayDate : null
    };
    
    // Validate and add
    if (isValidUrl(urlObj.loc)) {
      urlList.push(urlObj);
    }
  }
  
  textarea.value = '';
  updateDisplay();
}

// Update display
function updateDisplay() {
  // Update stats
  const validCount = urlList.length;
  document.getElementById('totalUrls').textContent = validCount;
  document.getElementById('validUrls').textContent = validCount;
  document.getElementById('invalidUrls').textContent = '0';
  
  // Show preview section
  if (validCount > 0) {
    document.getElementById('previewSection').style.display = 'block';
    document.getElementById('urlCount').textContent = validCount;
    
    // Update URL list
    const listContainer = document.getElementById('urlList');
    listContainer.innerHTML = '';
    
    urlList.forEach((url, index) => {
      const item = document.createElement('div');
      item.className = 'url-item';
      item.innerHTML = `
        <div class="url-number">${index + 1}</div>
        <div class="url-text">${url.loc}</div>
        <button class="remove-url" onclick="removeUrl(${index})">√ó</button>
      `;
      listContainer.appendChild(item);
    });
  } else {
    document.getElementById('previewSection').style.display = 'none';
  }
}

// Remove URL
function removeUrl(index) {
  urlList.splice(index, 1);
  updateDisplay();
}

// Clear all URLs
function clearAllUrls() {
  urlList = [];
  updateDisplay();
}

// Generate sitemap
function generateSitemap() {
  if (urlList.length === 0) {
    alert('L√ºtfen √∂nce URL ekleyin!');
    return;
  }
  
  // Build XML
  xmlContent = '<?xml version="1.0" encoding="UTF-8"?>\n';
  xmlContent += '<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">\n';
  
  for (let url of urlList) {
    xmlContent += '  <url>\n';
    xmlContent += `    <loc>${escapeXml(url.loc)}</loc>\n`;
    
    if (url.lastmod) {
      xmlContent += `    <lastmod>${url.lastmod}</lastmod>\n`;
    }
    
    xmlContent += `    <changefreq>${url.changefreq}</changefreq>\n`;
    xmlContent += `    <priority>${url.priority.toFixed(1)}</priority>\n`;
    xmlContent += '  </url>\n';
  }
  
  xmlContent += '</urlset>';
  
  // Copy to clipboard
  copyToClipboard(xmlContent);
  
  // Show preview
  showXmlPreview();
  
  // Show download button
  document.getElementById('downloadBtn').style.display = 'inline-flex';
}

// Escape XML
function escapeXml(unsafe) {
  return unsafe.replace(/[<>&'"]/g, function (c) {
    switch (c) {
      case '<': return '&lt;';
      case '>': return '&gt;';
      case '&': return '&amp;';
      case '\'': return '&apos;';
      case '"': return '&quot;';
    }
  });
}

// Copy to clipboard
function copyToClipboard(text) {
  // Try modern API first
  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(text).then(() => {
      showSuccess();
    }).catch(() => {
      fallbackCopy(text);
    });
  } else {
    fallbackCopy(text);
  }
}

// Fallback copy
function fallbackCopy(text) {
  const textarea = document.createElement('textarea');
  textarea.value = text;
  textarea.style.position = 'fixed';
  textarea.style.top = '0';
  textarea.style.left = '0';
  textarea.style.opacity = '0';
  
  document.body.appendChild(textarea);
  textarea.focus();
  textarea.select();
  
  try {
    document.execCommand('copy');
    showSuccess();
  } catch (err) {
    alert('Kopyalama ba≈üarƒ±sƒ±z oldu. L√ºtfen manuel olarak kopyalayƒ±n.');
  }
  
  document.body.removeChild(textarea);
}

// Show success message
function showSuccess() {
  const message = document.getElementById('successMessage');
  message.classList.add('show');
  
  setTimeout(() => {
    message.classList.remove('show');
  }, 3000);
}

// Show XML preview
function showXmlPreview() {
  document.getElementById('xmlPreviewSection').style.display = 'block';
  
  // Format for preview
  const formatted = xmlContent
    .replace(/</g, '&lt;')
    .replace(/>/g, '&gt;')
    .replace(/(&lt;\/?)(\w+)/g, '$1<span class="xml-tag">$2</span>')
    .replace(/(\w+)=/g, '<span class="xml-attr">$1</span>=')
    .replace(/"([^"]*)"/g, '"<span class="xml-value">$1</span>"');
  
  document.getElementById('xmlPreview').innerHTML = formatted;
}

// Download sitemap
function downloadSitemap() {
  if (!xmlContent) return;
  
  const blob = new Blob([xmlContent], { type: 'text/xml' });
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url;
  a.download = 'sitemap.xml';
  document.body.appendChild(a);
  a.click();
  document.body.removeChild(a);
  URL.revokeObjectURL(url);
}

// Reset all
function resetAll() {
  urlList = [];
  xmlContent = '';
  document.getElementById('csvFile').value = '';
  document.getElementById('fileInfo').classList.remove('show');
  document.getElementById('manualUrls').value = '';
  document.getElementById('mainDomain').value = '';
  document.getElementById('priority').value = '0.8';
  document.getElementById('changefreq').value = 'daily';
  document.getElementById('previewSection').style.display = 'none';
  document.getElementById('xmlPreviewSection').style.display = 'none';
  document.getElementById('downloadBtn').style.display = 'none';
  updateDisplay();
}
</script>

</body>
</html>
